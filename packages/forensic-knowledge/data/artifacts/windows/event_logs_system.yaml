name: System Event Log
description: "Windows System event log recording service operations, driver events, and system-level changes"
platform: windows

locations:
  - path: "C:\\Windows\\System32\\winevt\\Logs\\System.evtx"
    os_versions: ["Windows Vista+", "Windows 10", "Windows 11"]
    notes: "Always enabled by default; log size may limit retention"

proves:
  - "Services were installed, started, or stopped"
  - "System shutdown and restart events with reason codes"
  - "Driver load events"
  - "Time change events"
  - "Windows Update installation events"

does_not_prove:
  - "Who installed a service (no user attribution in 7045 by default)"
  - "What a service did after starting"
  - "That a service is malicious"
  - "Root cause of system crashes (requires memory dump analysis)"

timestamps:
  - field: "TimeCreated"
    meaning: "Time the event was generated by the Windows event logging subsystem"
    common_misinterpretation: "Generally reliable; Event ID 1 (time change) can indicate prior time manipulation"

common_misinterpretations:
  - claim: "Event ID 7045 proves who installed the service"
    correction: "7045 (new service installed) records the service name, binary path, and service type, but the AccountName field often shows LocalSystem rather than the user who performed the installation. Correlate with Security 4697 for user attribution."
  - claim: "Event ID 7036 proves a service was running"
    correction: "7036 records service state transitions (running/stopped). It proves the service changed state at that time, not that it was continuously running."
  - claim: "Event ID 1074 captures all shutdowns"
    correction: "1074 records planned shutdowns/restarts with reason. Unexpected shutdowns (power loss, BSOD) generate Event ID 6008 instead."
  - claim: "System log always has complete history"
    correction: "System.evtx has a configurable maximum size (default 20MB). On active systems, this may only retain days to weeks of events."

corroborate_with:
  for_execution: [event_logs_security, event_logs_sysmon, prefetch]
  for_presence: [registry_services, mft]
  for_timeline: [event_logs_security, event_logs_powershell, usn_journal]

related_tools: [EvtxECmd, Hayabusa]

cross_mcp_checks:
  - mcp: "windows-triage"
    tool: "check_process_tree"
    when: "Process execution event found — verify parent-child relationship against baseline"
  - mcp: "opencti"
    tool: "lookup_ioc"
    when: "IP address, domain, or hash found in event — check threat intelligence"
  - mcp: "forensic-rag"
    tool: "search"
    when: "Suspicious event pattern — search for detection rules and MITRE technique context"

references:
  - "SANS FOR500 - Windows Forensic Analysis"
  - "SANS FOR508 - Advanced Incident Response"
