name: SRUM
description: "System Resource Usage Monitor database tracking application resource consumption over time"
platform: windows

locations:
  - path: "C:\\Windows\\System32\\sru\\SRUDB.dat"
    os_versions: ["Windows 8+", "Windows 10", "Windows 11"]
    notes: "ESE database; requires offline parsing or VSS copy. Registry backup at SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SRUM\\Extensions"

proves:
  - "Application was executed and consumed system resources"
  - "Network data sent and received per application (bytes in/out)"
  - "Network connectivity profiles and durations"
  - "Application energy usage and CPU time"
  - "User SID associated with application resource usage"

does_not_prove:
  - "Exact execution start or stop times (data is aggregated in hourly intervals)"
  - "What network destinations were contacted"
  - "What files were accessed by the application"
  - "Specific actions performed by the application"

timestamps:
  - field: "TimeStamp"
    meaning: "Start of the 1-hour aggregation interval during which the resource usage was recorded"
    common_misinterpretation: "Often mistaken for exact execution time; it represents the beginning of the hourly bucket"

common_misinterpretations:
  - claim: "SRUM timestamps represent exact execution times"
    correction: "SRUM aggregates data in approximately 1-hour intervals. Timestamps represent the start of the interval, not precise execution times."
  - claim: "SRUM only retains 30 days of data"
    correction: "SRUM can retain 30-60+ days of data depending on system activity. The retention period is configurable and may vary."
  - claim: "SRUM network data shows destination IPs"
    correction: "SRUM records total bytes sent/received per application and network interface, but does NOT record destination addresses or URLs."
  - claim: "SRUM data is lost on reboot"
    correction: "SRUM persists data to SRUDB.dat (ESE database). In-memory data is flushed to disk periodically and on clean shutdown."

corroborate_with:
  for_execution: [prefetch, bam, amcache]
  for_presence: [mft, shimcache]
  for_timeline: [prefetch, event_logs_security, event_logs_sysmon]

related_tools: [SrumECmd]

cross_mcp_checks:
  - mcp: "opencti"
    tool: "lookup_ioc"
    when: "URL, domain, or IP identified — check threat intelligence"
  - mcp: "forensic-rag"
    tool: "search"
    when: "Suspicious network or browsing pattern — search for related techniques"

references:
  - "SANS FOR500 - Windows Forensic Analysis"
  - "Yogesh Khatri - SRUM Forensics"
