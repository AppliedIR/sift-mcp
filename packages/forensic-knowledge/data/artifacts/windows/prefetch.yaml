name: Prefetch
description: "Windows Prefetch files that record application execution to optimize load times"
platform: windows

locations:
  - path: "C:\\Windows\\Prefetch\\*.pf"
    os_versions: ["Windows XP+", "Windows 10", "Windows 11"]
    notes: "May be disabled on some SSD-only systems (varies by OEM and Windows version); always check HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Memory Management\\PrefetchParameters\\EnablePrefetcher"

proves:
  - "Application was executed"
  - "Execution count (number of times run)"
  - "Files and directories referenced during first 10 seconds of execution"
  - "Volume information where the executable resided"

does_not_prove:
  - "Who executed the program (no user attribution)"
  - "What the program did after loading"
  - "That the program completed successfully"

timestamps:
  - field: "PF file creation time (filesystem)"
    meaning: "First time the application was executed (approximately)"
    common_misinterpretation: "Sometimes confused with last execution time"
  - field: "PF file modification time (filesystem)"
    meaning: "Last time the application was executed"
    common_misinterpretation: "Rarely misinterpreted but may reflect OS prefetch service update timing"
  - field: "Last run timestamps (embedded, up to 8)"
    meaning: "Up to 8 most recent execution timestamps (Windows 8+ only)"
    common_misinterpretation: "Only the most recent is stored in pre-Win8 systems; analysts sometimes miss the additional 7"

common_misinterpretations:
  - claim: "Prefetch is always enabled on Windows 10/11"
    correction: "Prefetch may be disabled on SSD-only systems or via group policy. Always verify EnablePrefetcher registry value."
  - claim: "The prefetch file name hash uniquely identifies the executable"
    correction: "The hash incorporates the executable path and command-line hosting information. The same binary run from different paths generates different .pf files."
  - claim: "Prefetch proves the user who ran the program"
    correction: "Prefetch has no user attribution. Corroborate with UserAssist, BAM, or Security event logs for user context."
  - claim: "128 prefetch file limit means old data is always lost"
    correction: "Windows 8+ raised the limit to 1024 .pf files. Windows 7 and earlier had a 128 file limit."

corroborate_with:
  for_execution: [amcache, userassist, bam]
  for_presence: [mft, shimcache]
  for_timeline: [usn_journal, event_logs_security, srum]

related_tools: [PECmd]

cross_mcp_checks:
  - mcp: "windows-triage"
    tool: "check_file"
    when: "Executable path identified — verify against Windows baseline"
  - mcp: "opencti"
    tool: "lookup_hash"
    when: "File hash available — check threat intelligence"
  - mcp: "forensic-rag"
    tool: "search"
    when: "Suspicious executable or pattern — search for related MITRE techniques and detection rules"
  - mcp: "remnux"
    tool: "analyze_file"
    when: "Unknown executable — submit for static analysis"

references:
  - "SANS FOR500 - Windows Forensic Analysis"
  - "SANS FOR508 - Advanced Incident Response"
