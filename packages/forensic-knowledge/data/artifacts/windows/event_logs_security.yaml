name: Security Event Log
description: "Windows Security event log recording authentication, authorization, and audit events"
platform: windows

locations:
  - path: "C:\\Windows\\System32\\winevt\\Logs\\Security.evtx"
    os_versions: ["Windows Vista+", "Windows 10", "Windows 11"]
    notes: "Requires audit policies to be configured; many events are not logged by default"

proves:
  - "Authentication events occurred (logon, logoff, failed logon)"
  - "User account and logon type for authentication events"
  - "Source network address for remote logons"
  - "Process creation events (when 4688 auditing is enabled)"
  - "Privilege usage and special privilege assignment"
  - "Object access events (when configured)"

does_not_prove:
  - "What a user did after logging on (unless specific audit policies are enabled)"
  - "File content that was accessed"
  - "That a logon was interactive at the keyboard (Type 3 is network, Type 10 is RDP, etc.)"

timestamps:
  - field: "TimeCreated"
    meaning: "Time the event was generated by the Windows audit subsystem"
    common_misinterpretation: "Generally reliable, but can be affected by system time changes or time zone misconfiguration"

common_misinterpretations:
  - claim: "Event ID 4624 means someone sat at the keyboard"
    correction: "4624 records all logon types. Logon Type 2 is interactive, Type 3 is network, Type 7 is unlock, Type 10 is RDP. Always check the Logon Type field."
  - claim: "Event ID 4648 means credentials were stolen"
    correction: "4648 (explicit credential logon) fires when a user provides credentials different from their current session — common with runas, mapped drives, and scheduled tasks. Suspicious but not inherently malicious."
  - claim: "Absence of 4625 events means no brute force occurred"
    correction: "Account lockout policies may suppress repeated 4625 events. Network logon failures may be logged on the target, not the source."
  - claim: "Event ID 4672 always indicates privilege escalation"
    correction: "4672 (special privileges assigned to new logon) fires for every admin logon. It indicates the logon session HAS admin privileges, not that privilege escalation occurred."
  - claim: "Process creation (4688) always shows the full command line"
    correction: "Command-line logging in 4688 must be explicitly enabled via group policy (Include command line in process creation events). It is NOT enabled by default."

corroborate_with:
  for_execution: [prefetch, event_logs_sysmon, bam]
  for_presence: [mft, amcache]
  for_timeline: [prefetch, event_logs_system, event_logs_powershell, srum]

related_tools: [EvtxECmd, Hayabusa]

cross_mcp_checks:
  - mcp: "windows-triage"
    tool: "check_process_tree"
    when: "Process execution event found — verify parent-child relationship against baseline"
  - mcp: "opencti"
    tool: "lookup_ioc"
    when: "IP address, domain, or hash found in event — check threat intelligence"
  - mcp: "forensic-rag"
    tool: "search"
    when: "Suspicious event pattern — search for detection rules and MITRE technique context"

references:
  - "SANS FOR500 - Windows Forensic Analysis"
  - "SANS FOR508 - Advanced Incident Response"
  - "Microsoft - Windows Security Auditing"
  - "NSA - Spotting the Adversary with Windows Event Log Monitoring"
