name: YARA
category: malware
description: "Pattern matching tool for malware identification and classification using rule-based signatures"
platform: [windows, linux, macos]
platform_notes: "Available on all platforms. On Linux, can scan /proc/[pid]/mem directly for live process scanning. Same flags otherwise."
artifacts_parsed: []

caveats:
  - "YARA matches patterns — a match does not confirm malware; false positives require analyst validation"
  - "Rule quality varies enormously; community rules may have high false positive rates"
  - "YARA scans file content, not behavior — packed, encrypted, or obfuscated malware may evade detection"
  - "Scanning large volumes of files or memory dumps is resource-intensive and time-consuming"
  - "Rules must be tested against known-good files to establish false positive baselines"
  - "String matching is case-sensitive by default; rules must explicitly use 'nocase' modifier"
  - "PE module rules only work on PE files; applying them to other file types wastes time"

output_notes:
  format: text
  key_fields: [rule_name, matched_file, matched_strings, tags]

exit_code_hints:
  0: "no match or success"
  1: "error"

advisories:
  - "Use curated rule sets: YARA-Rules, Signature-Base (Florian Roth), and Malpedia for production use"
  - "The -r flag enables recursive directory scanning; -s shows matched strings for validation"
  - "Combine YARA with hash lookups for defense in depth — YARA catches variants that hash matching misses"
  - "Memory scanning (YARA on RAM dumps) can detect unpacked malware that is packed on disk"
  - "Use -p flag to specify thread count for faster scanning of large file collections"
  - "Always include metadata (author, date, description, reference) in custom rules for traceability"
  - "YARA rules can scan processes directly on live Linux systems via /proc/[pid]/mem"

quick_start: "yara rules.yar target_file"

investigation_sequence:
  - "Compile or select YARA rules appropriate for the investigation (malware family, IOC patterns)"
  - "Scan target files or directories for rule matches"
  - "Review all matches including metadata tags for classification context"
  - "Cross-reference matched indicators with threat intelligence sources"
  - "Use -s flag to show matching strings for detailed analysis"
  - "Scan across multiple evidence sources — malware may exist in different locations"
  - "Document rule names, match locations, and matched strings as evidence"
