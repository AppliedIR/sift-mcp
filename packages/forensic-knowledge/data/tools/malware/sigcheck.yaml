name: sigcheck
category: malware
description: "Sysinternals tool for verifying digital signatures, checking VirusTotal scores, and examining PE file details"
platform: [windows]
platform_notes: "Windows only (Sysinternals). No Linux equivalent. For signature verification on Linux, use osslsigncode."
artifacts_parsed: [digital_signatures]

caveats:
  - "A valid digital signature does NOT guarantee a file is safe — stolen/compromised certificates exist"
  - "Catalog-signed vs embedded-signed files are detected differently"
  - "VirusTotal integration requires accepting the EULA and sends file hashes to VirusTotal"
  - "Unsigned files are common for legitimate scripts, custom tools, and some open-source software"
  - "Certificate chain validation requires internet access for revocation checking"
  - "Timestamped signatures remain valid after certificate expiration — check timestamp validity separately"

output_notes:
  format: csv
  key_fields: [Path, Verified, Publisher, Company, Description, Product, Version, FileVersion, MachineType, MD5, SHA1, SHA256, PESHA1, PESHA256, IMP]

exit_code_hints:
  0: "success"
  1: "error"

advisories:
  - "Use -e to scan a directory for unsigned executables — common first triage step"
  - "Use -vt to check VirusTotal detection ratios (requires accepting EULA with -v flag first time)"
  - "Use -c for CSV output and -ct for tab-delimited output"
  - "Use -h to show file hashes alongside signature information"
  - "Use -u to show only unsigned files — filters out legitimately signed binaries"
  - "Combine with autorunsc to verify signatures of all persistence mechanisms"
  - "Use -s for recursive scanning of subdirectories"

quick_start: "sigcheck.exe -e -s -h C:\\Windows\\System32"

investigation_sequence:
  - "Scan system directories for unsigned or anomalously signed executables (via wintools-mcp)"
  - "Use -c for CSV output suitable for bulk analysis"
  - "Use -u to filter to unsigned files only for focused investigation"
  - "Review all results including signed files — valid signatures do not guarantee legitimacy"
  - "Cross-reference file hashes with threat intelligence sources"
  - "Use -v/-vt to check files against VirusTotal (requires network and VT terms acceptance)"
  - "Compare signature status with expected baselines from windows-triage tools"
  - "Correlate findings with autorunsc persistence analysis"
  - "Cross-MCP: Verify unsigned files against Windows baseline (windows-triage: check_file)"
  - "Cross-MCP: Submit unsigned or invalid-signature files for analysis (remnux: analyze_file)"

field_meanings:
  Path: "Full file path of the scanned executable"
  Verified: "Signature verification status (Signed, Unsigned, Invalid)"
  Date: "Signing timestamp or file modification date"
  Publisher: "Certificate publisher name from the digital signature"
  Company: "Company name from the PE version information"
  Description: "File description from the PE version information"
  Product: "Product name from the PE version information"
  "Product Version": "Product version string"
  "File Version": "File version string"
  "Machine Type": "Target architecture (32-bit, 64-bit, ARM)"
  MD5: "MD5 hash of the file"
  SHA1: "SHA1 hash of the file"
  SHA256: "SHA256 hash of the file"
  PESHA1: "SHA1 hash of the PE image (excludes signature data)"
  PESHA256: "SHA256 hash of the PE image (excludes signature data)"
  IMP: "Import hash (imphash) for behavioral similarity comparison"
