name: maldump
category: malware
description: "Extract malware samples from antivirus quarantine directories"
platform: [windows, linux]
platform_notes: "Python-based. On Windows, accesses local AV quarantine directly. On Linux, processes quarantine files from collected images."
artifacts_parsed: [defender_quarantine]

caveats:
  - "Extracted files are LIVE MALWARE — handle with extreme caution in isolated environments"
  - "Not all antivirus quarantine formats are supported"
  - "Quarantine metadata may include original file path and detection name"
  - "Some AV products encrypt quarantine with per-installation keys, limiting offline extraction"
  - "Requires appropriate permissions to access quarantine directories"

output_notes:
  format: binary_files
  key_fields: [original_path, detection_name, quarantine_date, extracted_file]

exit_code_hints:
  0: "success"
  1: "error"

advisories:
  - "Always extract quarantined files in a sandboxed or isolated analysis environment"
  - "Supported AV formats include Windows Defender, Kaspersky, McAfee, Symantec, and others"
  - "Quarantine entries reveal what the AV detected and when — timeline value even without extraction"
  - "Original file paths from quarantine metadata indicate where malware was on disk"
  - "Feed extracted samples to YARA, CAPA, and VirusTotal for comprehensive classification"

quick_start: "maldump scan"

investigation_sequence:
  - "Scan the system for malware artifacts in common persistence and staging locations"
  - "Review all findings — the tool provides initial triage, not definitive classification"
  - "Cross-reference discovered files with YARA rules and capa analysis"
  - "Submit file hashes to threat intelligence sources for known malware identification"
  - "Correlate findings with other artifact evidence from the investigation"
