name: CAPA
category: malware
description: "Detect capabilities in executable files using a rule-based framework mapped to MITRE ATT&CK"
platform: [windows, linux, macos]
platform_notes: "Python-based with pre-built binaries available. Works identically on all platforms."
artifacts_parsed: []

caveats:
  - "Capability detection is STATIC analysis — identifies what code CAN do, not what it DID do"
  - "Packed, encrypted, or heavily obfuscated executables may evade detection"
  - "Rule matches indicate potential capabilities, not confirmed malicious behavior"
  - "False positives are common for legitimate tools that share capabilities with malware"
  - "Limited to PE files, ELF files, and shellcode — cannot analyze scripts or documents"
  - "Rule coverage varies; not all malware families or techniques have rules"

output_notes:
  format: text_or_json
  key_fields: [capability, namespace, ATT&CK_technique, MBC_behavior, scope]

exit_code_hints:
  0: "success — capabilities found or clean analysis"
  1: "error"

advisories:
  - "Use -j for JSON output suitable for automated processing and integration"
  - "ATT&CK technique mappings enable direct correlation with threat intelligence"
  - "Compare CAPA results with YARA matches and behavioral analysis for comprehensive assessment"
  - "Use -v for verbose output showing matched addresses and rule details"
  - "CAPA rules are community-maintained and updated regularly — keep rules current"
  - "The MBC (Malware Behavior Catalog) mappings provide additional behavioral context beyond ATT&CK"

quick_start: "capa suspicious.exe"

investigation_sequence:
  - "Run capa against the suspicious executable to enumerate behavioral capabilities (via sift-mcp or wintools-mcp)"
  - "Review all detected capabilities — capa does not assign severity scores, so all results warrant examination"
  - "Use -v for function-level detail and -vv for exact matching addresses and evidence"
  - "Map detected ATT&CK techniques to the broader investigation context"
  - "Use namespace categorization to understand the functional purpose of detected behaviors"
  - "Cross-reference with YARA rules and strings analysis for corroboration"
  - "Submit file hashes to threat intelligence sources for known malware identification"
  - "Cross-MCP: Search forensic-rag for context on identified MITRE techniques (forensic-rag: search)"
  - "Cross-MCP: Submit sample for complementary analysis (remnux: analyze_file)"

field_meanings:
  "ATT&CK Tactic": "MITRE ATT&CK tactic mapping (e.g., Defense Evasion, Execution)"
  "ATT&CK Technique": "Specific ATT&CK technique ID and name (e.g., T1055 Process Injection)"
  CAPABILITY: "Human-readable description of the detected behavioral capability"
  NAMESPACE: "Hierarchical functional categorization (e.g., c2/shell, persistence/service)"
