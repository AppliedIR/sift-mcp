name: "1768.py"
category: malware
description: "Cobalt Strike beacon configuration extractor and parser"
platform: [windows, linux, macos]
platform_notes: "Python script. Works on all platforms. Analyzes Cobalt Strike beacon binaries regardless of host OS."
artifacts_parsed: []

caveats:
  - "May not work on heavily modified or custom Cobalt Strike beacons"
  - "Only extracts configuration data — does not provide behavioral analysis"
  - "Newer Cobalt Strike versions may use configurations not yet supported"
  - "False negatives are possible with obfuscated or sleep-encrypted beacons"
  - "Configuration fields require analyst interpretation (C2 URLs, sleep times, watermarks)"

output_notes:
  format: text_or_json
  key_fields: [C2Server, Port, SleepTime, Jitter, PublicKey, UserAgent, Watermark, BeaconType]

exit_code_hints:
  0: "success or no config found"
  1: "error"

advisories:
  - "C2 server addresses in extracted config are critical IOCs — feed to threat intel immediately"
  - "Watermark values can link beacons to specific Cobalt Strike licenses"
  - "Sleep time and jitter values help identify beacon traffic patterns in network data"
  - "Compare extracted configs with threat intel databases for campaign attribution"
  - "Use alongside YARA CS rules and CAPA for comprehensive beacon analysis"
  - "Multiple extraction tools exist (CobaltStrikeParser, BeaconEye) — cross-validate results"

quick_start: "python 1768.py beacon_file"

investigation_sequence:
  - "Run 1768.py against suspected Cobalt Strike beacon files to extract configuration"
  - "Review all extracted configuration fields — each provides C2 infrastructure intelligence"
  - "Use -J for JSON output suitable for structured analysis and IOC extraction"
  - "Extract C2 server addresses, ports, and URI paths for network-based detection"
  - "Note the watermark value — this identifies the Cobalt Strike license used"
  - "Cross-reference C2 domains and IPs with threat intelligence sources"
  - "Correlate beacon configuration with network traffic analysis from tshark/Zeek"
  - "Check for named pipe names that may indicate lateral movement mechanisms"

field_meanings:
  BeaconType: "C2 protocol type (HTTP, HTTPS, DNS, SMB)"
  Port: "C2 communication port"
  SleepTime: "Beacon callback interval in milliseconds"
  Jitter: "Sleep time randomization percentage (0-100)"
  C2Server: "Command and control server addresses"
  UserAgent: "HTTP User-Agent string used for C2 communication"
  SubmitUri: "URI path for data submission to the C2 server"
  SpawnTo: "Default process name used for process injection"
  PipeName: "Named pipe name for SMB beacon communication"
  KillDate: "Date after which the beacon will stop operating"
  Watermark: "Cobalt Strike license watermark identifier"
  CryptoScheme: "Encryption scheme used for C2 communication"
  ProxyConfig: "Proxy server configuration for C2 egress"
  SpawnTo_x86: "32-bit process target for injection operations"
  SpawnTo_x64: "64-bit process target for injection operations"
