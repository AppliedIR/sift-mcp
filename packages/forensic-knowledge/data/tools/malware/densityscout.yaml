name: densityscout
category: malware
description: "Calculate byte density (entropy) of files to identify packed, encrypted, or compressed executables"
platform: [windows, linux]
platform_notes: "Windows native binary. Linux version available. Same flags and output."
artifacts_parsed: []

caveats:
  - "High entropy alone does NOT confirm malware — compressed resources, .NET assemblies, and media files have high entropy"
  - "Entropy thresholds are guidelines: 7.0+ suspicious, 7.9+ likely packed/encrypted"
  - "Low entropy does not guarantee a file is benign — some malware uses low-entropy encoding"
  - "Results must be corroborated with other analysis (YARA, CAPA, behavioral analysis)"
  - "Large file scans can be time-consuming; target specific directories for efficiency"

output_notes:
  format: text
  key_fields: [density_score, filename]

exit_code_hints:
  0: "success"

advisories:
  - "Use as a triage tool to prioritize files for deeper analysis"
  - "Sort output by density score to identify outliers quickly"
  - "Combine with sigcheck to check if high-entropy files are signed"
  - "Use -p for PE-only mode to focus on executable files"
  - "Use -o to specify output directory for results"
  - "Particularly useful for finding packed executables in large collections of files"

quick_start: "densityscout -pe -r -o results.txt C:\\Windows\\System32"

investigation_sequence:
  - "Scan directories of interest for files with anomalous byte density (via wintools-mcp)"
  - "Use -pe flag to filter to PE files only for focused analysis"
  - "Review results sorted by density score — lower scores indicate higher packing/encryption probability"
  - "Do not rely on density alone — legitimate packers and encrypted resources produce low scores too"
  - "Cross-reference low-density files with sigcheck for signature validation"
  - "Submit suspicious files to capa and YARA for behavioral and signature analysis"
  - "Correlate findings with other malware indicators from the investigation"
  - "Cross-MCP: Submit high-entropy files for static analysis (remnux: analyze_file)"
  - "Cross-MCP: Check file hashes against threat intelligence (opencti: lookup_hash)"

field_meanings:
  density_score: "Byte frequency distribution score — lower values indicate more uniform distribution (potential packing/encryption)"
  filepath: "Full path to the scanned file"
