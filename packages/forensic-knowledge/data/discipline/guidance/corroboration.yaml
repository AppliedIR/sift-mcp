corroboration:
  persistence:
    - check: "windows-triage: check_autorun / check_service / check_scheduled_task"
      reason: "Verify against known Windows baseline"
    - check: "forensic-rag: search for technique"
      reason: "Identify MITRE technique and known detection methods"
    - check: "opencti: lookup_ioc on associated files/hashes"
      reason: "Check threat intelligence for known malicious indicators"
    - check: "Timeline analysis of creation timestamp"
      reason: "Determine when persistence was established"
    - check: "remnux: analyze_file on unsigned persistence binary"
      reason: "Determine capabilities of the persisted executable"
  lateral_movement:
    - check: "Network connection logs (firewall, proxy)"
      reason: "Verify connection between source and destination"
    - check: "Authentication logs on destination"
      reason: "Identify account used and authentication method"
    - check: "Process execution on destination"
      reason: "Identify what was executed after lateral movement"
    - check: "opencti: search for technique/tool"
      reason: "Match against known lateral movement tools and techniques"
  malware:
    - check: "opencti: lookup_hash"
      reason: "Check file hash against threat intelligence"
    - check: "windows-triage: check_file"
      reason: "Verify file is not a known Windows component"
    - check: "remnux: analyze_file"
      reason: "Static and dynamic analysis of suspicious file"
    - check: "forensic-rag: search for behavior"
      reason: "Match observed behavior to known malware techniques"
  credential_access:
    - check: "Authentication logs (Event ID 4624/4625)"
      reason: "Identify authentication patterns"
    - check: "windows-triage: check_process_tree"
      reason: "Check for credential dumping tool process trees"
    - check: "forensic-rag: search T1003"
      reason: "Identify credential dumping technique variants"
    - check: "Memory analysis for credential artifacts"
      reason: "Direct evidence of credentials in memory"
  suspicious_binary:
    - check: "windows-triage: check_file"
      reason: "Verify against known Windows baseline"
    - check: "sigcheck or autorunsc for digital signature"
      reason: "Unsigned binaries in system directories warrant investigation"
    - check: "densityscout for entropy analysis"
      reason: "High entropy suggests packing, encryption, or obfuscation"
    - check: "opencti: lookup_hash"
      reason: "Check if the hash is associated with known malware"
    - check: "remnux: analyze_file"
      reason: "Comprehensive static analysis reveals capabilities, imports, strings, and IOCs"
    - check: "remnux: analyze_file with depth deep"
      reason: "Deep analysis when initial indicators are strong"
  suspicious_document:
    - check: "remnux: analyze_file"
      reason: "Detect macros, embedded objects, exploits, and obfuscated content in Office/PDF files"
    - check: "opencti: lookup_hash"
      reason: "Check document hash against threat intelligence"
    - check: "forensic-rag: search for document-based attack techniques"
      reason: "Match against known document exploit patterns"
  process_injection:
    - check: "hollows_hunter or moneta for injection detection"
      reason: "Identify hollowed processes, injected threads, suspicious memory regions"
    - check: "remnux: analyze_file on dumped memory regions"
      reason: "Analyze extracted shellcode or injected PE for capabilities"
    - check: "windows-triage: check_process_tree"
      reason: "Verify parent-child relationships are expected"
    - check: "forensic-rag: search for injection technique"
      reason: "Identify the specific injection method (T1055 sub-techniques)"
  unknown_execution:
    - check: "PECmd for Prefetch entries"
      reason: "Confirm execution and identify execution count and timestamps"
    - check: "AmcacheParser for installation records"
      reason: "Determine when executable first appeared on system"
    - check: "windows-triage: check_file on the executable path"
      reason: "Verify against known Windows baseline"
    - check: "remnux: analyze_file"
      reason: "Determine what the unknown executable does before drawing conclusions"
    - check: "opencti: lookup_hash"
      reason: "Check hash against threat intelligence for known associations"
