rules:
  - id: "FD-001"
    name: "evidence_before_claims"
    severity: "critical"
    description: "Every claim must reference at least one evidence_id from an actual tool call"
    enforcement: "forensic_mcp_validates_on_stage"
    when_to_apply: "When recording any finding or timeline event via record_finding() or record_timeline_event()"
    how_to_apply: "Include at least one evidence_id in the finding. Each evidence_id must come from an actual tool call in the current session. Do not fabricate or reuse IDs from memory."
  - id: "FD-002"
    name: "human_approval_for_findings"
    severity: "critical"
    description: "Findings and timeline entries require human approval before becoming official"
    enforcement: "forensic_mcp_stages_as_draft"
    when_to_apply: "After staging any finding or timeline event — before referencing it as established fact"
    how_to_apply: "Stage via record_finding(). Do not build subsequent analysis on DRAFT findings. Inform the examiner that approval is needed via aiir CLI. Wait for APPROVED status."
  - id: "FD-003"
    name: "no_autonomous_attribution"
    severity: "critical"
    description: "Threat actor attribution requires human approval and multiple corroborating evidence sources"
    enforcement: "forensic_mcp_requires_type_attribution_with_min_evidence_3"
    when_to_apply: "When TTPs, infrastructure, or tooling match a known threat actor and you are tempted to name them"
    how_to_apply: "Require at least 3 independent evidence sources from different categories (e.g., TTP match + infrastructure overlap + tooling signature). Stage as DRAFT with type=attribution. Present alternative attributions."
  - id: "FD-004"
    name: "unknown_is_neutral"
    severity: "high"
    description: "UNKNOWN verdicts from triage mean not-in-database, not suspicious"
    enforcement: "windows_triage_response_metadata"
    when_to_apply: "When windows-triage or similar tools return UNKNOWN or NOT_FOUND for a checked artifact"
    how_to_apply: "Treat UNKNOWN as 'not in baseline database' — it is neither benign nor malicious. Investigate further with other tools before drawing conclusions. Do not escalate based on UNKNOWN alone."
  - id: "FD-005"
    name: "confidence_must_be_justified"
    severity: "high"
    description: "Every confidence level must include a justification citing specific evidence"
    enforcement: "forensic_mcp_validates_on_stage"
    when_to_apply: "When setting the confidence field on any finding (SPECULATIVE, LOW, MEDIUM, HIGH)"
    how_to_apply: "Write a confidence_justification that names the specific evidence_ids and explains why they support the chosen level. Higher confidence requires more independent sources."
  - id: "FD-006"
    name: "no_premature_exclusion"
    severity: "high"
    description: "Do not rule out a hypothesis without evidence against it. Absence of evidence is not evidence of absence."
    enforcement: "advisory"
    when_to_apply: "When you are about to dismiss a hypothesis, mark an artifact as benign, or narrow investigation scope"
    how_to_apply: "Before excluding, ask: what evidence would confirm this hypothesis? Have I looked for it? If not, record a TODO to investigate before excluding. If excluding, document the specific evidence that argues against the hypothesis."
  - id: "FD-007"
    name: "corroborate_before_escalate"
    severity: "high"
    description: "Findings from a single source must be corroborated before escalation or action"
    enforcement: "forensic_mcp_requires_min_evidence_by_confidence"
    when_to_apply: "Before recommending any operational action (containment, notification, escalation) based on investigation findings"
    how_to_apply: "Verify the finding with at least one independent source. Use the corroboration suggestions from tool responses. If corroboration is not possible, state this limitation explicitly and lower the confidence level."
