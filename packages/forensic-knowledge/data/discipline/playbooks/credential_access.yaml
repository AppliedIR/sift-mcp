name: "Credential Access Investigation"
description: "Investigate indicators of credential theft, dumping, or Kerberos abuse"
mitre: ["T1003", "T1558"]
sources:
  - "SANS FOR508 — Windows Enterprise Incident Response"
  - "MITRE ATT&CK T1003 — OS Credential Dumping"
  - "MITRE ATT&CK T1558 — Steal or Forge Kerberos Tickets"
triggers:
  - "LSASS access detected in Sysmon Event ID 10"
  - "Known credential tools in Prefetch (mimikatz, procdump, comsvcs.dll)"
  - "Kerberoasting event patterns (Event ID 4769 with RC4 encryption)"
  - "Suspicious process accessing credential stores"
phases:
  - phase: "Identify"
    steps:
      - "Parse Sysmon logs for LSASS access events with Hayabusa (via sift-mcp or wintools-mcp)"
      - "Check Prefetch for known credential tool execution using PECmd (via wintools-mcp)"
      - "Check running processes with Volatility3 pslist and psscan (via sift-mcp) if memory image available"
  - phase: "Tool Identification"
    steps:
      - "Check file hashes of suspected credential tools (opencti: lookup_hash)"
      - "Verify files against Windows baseline (windows-triage: check_file)"
      - "Submit unknown executables for static analysis (remnux: analyze_file)"
  - phase: "Scope"
    steps:
      - "Check for Kerberoasting events — Event ID 4769 with RC4 encryption type (0x17)"
      - "Check for pass-the-hash logon patterns — Event ID 4624 Type 9 or NTLM logons"
      - "Check for DCSync indicators — Event ID 4662 with replication rights GUIDs"
  - phase: "Impact"
    steps:
      - "Identify all accounts potentially compromised based on tool access patterns"
      - "Check for subsequent logons using potentially stolen credentials"
      - "Determine credential scope — local accounts, domain accounts, service accounts"
  - phase: "Record"
    steps:
      - "Record finding with all evidence IDs"
      - "HITL checkpoint — credential compromise affects investigation scope determination"
