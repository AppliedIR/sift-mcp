name: "Suspicious Network Connection Investigation"
description: "Investigate anomalous network connections including beaconing, unusual ports, and known-bad destinations"
mitre: ["T1071", "T1573"]
sources:
  - "SANS FOR572 — Advanced Network Forensics"
  - "MITRE ATT&CK T1071 — Application Layer Protocol"
  - "MITRE ATT&CK T1573 — Encrypted Channel"
triggers:
  - "Regular beaconing pattern detected in network traffic"
  - "Outbound connections on unusual ports"
  - "Connections to known-bad IP addresses or domains"
  - "High-volume data transfer to external destination"
  - "Long-duration connections inconsistent with normal traffic"
phases:
  - phase: "Identify"
    steps:
      - "Analyze PCAP or Zeek logs using tshark or zeek (via sift-mcp)"
      - "Check conversation statistics for beaconing patterns — regular intervals, consistent payload sizes"
      - "Identify top talkers and unusual protocol usage"
  - phase: "Threat Intel"
    steps:
      - "Check destination IPs and domains against threat intelligence (opencti: lookup_ioc)"
      - "Search for C2 communication patterns and known malware profiles (forensic-rag: search)"
  - phase: "Process Mapping"
    steps:
      - "If process data available, identify which process made the connection using Volatility3 netscan (via sift-mcp)"
      - "Check Sysmon Event ID 3 for network connection events with process context"
      - "Verify processes against baseline (windows-triage: check_process_tree)"
  - phase: "Payload"
    steps:
      - "Extract HTTP objects from PCAP using tshark --export-objects (via sift-mcp)"
      - "Check DNS queries for tunneling indicators — long labels, high query volume, TXT records"
      - "Analyze extracted payloads for malicious content (remnux: analyze_file)"
  - phase: "Record"
    steps:
      - "Record finding including network indicators, process context, and threat intelligence results"
      - "Include all evidence IDs from each analysis phase"
